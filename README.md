Pentesting Cheat Sheet
===================
version .01

Various findings, notes, and more from Pentesting all in one location.

----------


Nmap
-------------

Network scanner -

> **Introduction on port state**

> - Filtered: Blackhole, no icmp reply back or icmp error (IDS/Stateful firewall blocking). Could vary on scanning technique. Simply put, nMap can't confirm the real status of this port.
>> - -sV or -A can help detect true state.
>> - --tcp-flags SYN,FIN to try bypassing the firewall.
> - Closed: ICMP port unreachable reply




> **Getting all host names on a network:**
> ```
nmap -sS 10.11.1.201-254 -p53 -T4 -oG - | grep "open"
nano /etc/resolv.conf
host -l dc.name > hostsName
cat hostsNames | cut -f1,4 -d " "
> ```


----------


Wireshark
-------------

Network analyzer with UI -

> **Introduction on UI**

> - Packet List pane displays captured traffic by line.
> - Packets Details pane contains data seen in the middle part of Wireshark. The protocols and fields of the packet shown in a tree which can be expanded and collapsed.
> - Packets Bytes pane resembles a hex editor.
> - DisplayFilters only show what you want filtered
> - Capture Filters only capture the specified packets. Capture Filters will save on disk space!

----------


TShark
-------------

Network analyzer from cli -

> **Capture filtered traffic @ 5kb and iterated 3 times**

> ```
tshark -i eth0 -f "port 80 or port 443 or port 53" -b filesize:5 -a files:3 -w /tmp/CAPTURED.pcap
cd /tmp; watch -n 1 "ls -ltr"
> ```

> **Capture filter with multiple filters and lines**

> ```
tshark -i eth0 -f "
port 80
or
port 443"
> ```


-------------
 -- Finish Formating and building file --
-------------
Reading traffic captured (-T format, -e field):
tshark -r /tmp/testCap.pcap -T fields -e ip

Reading traffic captured:
tshark -r sampleCapture_1.pcap -T fields -e dns -e ip.src | uniq

Decrypting Wireless Traffic (must have key & ssid - use aircrack-ng before hand):
Wireshark > Edit > Preferences > IEEE (hit the keys) > Enable decryption. Edit decryption key - format is:  password:ssid (cake123:Frozen)

Decoding video:
Set display filter - ip.addr == (destination ip) && http
Locate HTTP/1.1 with video/mp2t
In Packet Details frame > Media Type > Media Type (binaries should be selected) > right click - export
Open file in VLC - doesn't need a file format.
